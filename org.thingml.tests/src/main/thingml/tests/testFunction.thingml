import "../../../../../org.thingml.samples/src/main/thingml/thingml.thingml"

thing TestFunction includes Test 
@test "x # xxxxxxxx;"
{
    //Test function call from a function
    function foo(a : UInt16, b : UInt16) : ULong do
    	return a + bar(b)
    end
    
    //Test recursive function
    function bar(a : UInt16) : ULong do
        if (a == 0) do
            return 0
        end
        if (a > 0) do
            return bar(a-1)
        end
        if (a < 0) do
            return bar(a+1)
        end
    end
    
  
    statechart TestPropertyPing init INIT {
    
    	state INIT {
			
			property a : UInt16 = 8
			
    		transition -> INIT
			event m : harness?testIn
			guard m.c == '\'x\''
			action do
				var result : ULong = foo(a, 5)
                var index : UInt16 = 0
                while (index < result) do
				    harness!testOut('\'x\'')
                    index = index + 1
                end
			end
			    		
    	}
    }
}